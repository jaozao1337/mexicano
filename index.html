<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MEXICANO EM PP</title>
    <!-- Referência ao ícone da aba -->
    <link rel="icon" type="image/png" href="mexicano.png">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.7.0/chart.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Warm Fiesta (Red, Amber, Orange, Green, Fuchsia) -->
    <!-- Application Structure Plan: A tabbed SPA structure ('Visão Geral', 'Receitas', 'Lista de Compras', 'Orçamento') was chosen for optimal user flow. This guides the user from planning (recipes) to action (shopping) and review (budget). 'Receitas' uses nested tabs for clarity. The 'Lista' and 'Orçamento' are linked via JS: checking items on the list dynamically updates the budget chart and totals, making the plan interactive and actionable. The modern design (shadows, large radius, vibrant colors) increases visual engagement and perceived fluidity. -->
    <!-- Visualization & Content Choices: Report Info: Recipes -> Goal: Inform -> Viz: Nested HTML tabs with hover effects -> Interaction: Click tabs to show/hide recipes -> Justification: Prevents info overload and adds visual flair. | Report Info: Shopping List -> Goal: Organize/Action -> Viz: Checkbox-enabled HTML lists with striped background -> Interaction: Check items (updates budget) -> Justification: Clear actionability and visual hierarchy. | Report Info: Budget -> Goal: Inform/Analyze -> Viz: Chart.js Doughnut Chart + Vibrant HTML Table -> Interaction: Chart updates based on shopping list checks -> Justification: Visually exciting breakdown of costs by category with real-time financial feedback. | CONFIRM: NO SVG/Mermaid. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #F9FAFB; 
        }
        .tab-button {
            transition: all 0.3s ease;
            position: relative;
        }
        .tab-button.active {
            color: #DC2626; /* Red-600 */
        }
        .tab-button.active::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 80%;
            height: 4px;
            background-color: #DC2626; /* Red-600 */
            border-radius: 9999px;
        }
        .recipe-tab-button {
            transition: background-color 0.2s, color 0.2s, transform 0.1s;
        }
        .recipe-tab-button:hover {
            transform: translateY(-1px);
        }
        .recipe-tab-button.active {
            background-color: #F59E0B; /* Amber-500 */
            color: white;
            box-shadow: 0 4px 6px -1px rgba(245, 158, 11, 0.3), 0 2px 4px -2px rgba(245, 158, 11, 0.3);
        }
        .content-card {
            background-color: white;
            border-radius: 1.5rem; /* rounded-2xl */
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.1); /* shadow-xl */
        }
        /* Responsiveness for Chart Container */
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 450px;
            margin-left: auto;
            margin-right: auto;
            min-height: 300px;
            height: 40vh; /* Responsive height on small screens */
            max-height: 450px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 450px; /* Larger height on desktop */
            }
        }
        /* Ajuste para a navegação de receitas no mobile, garantindo quebras corretas */
        .recipe-tab-container {
            display: flex;
            flex-wrap: wrap;
            gap: 8px; /* Espaçamento entre os botões */
        }
    </style>
</head>
<body class="text-neutral-800">

    <div class="container mx-auto max-w-6xl p-4 sm:p-10">
        
        <header class="text-center mb-8 sm:mb-10">
            <h1 class="text-4xl sm:text-5xl font-extrabold text-red-600 mb-1 sm:mb-2 tracking-tight">MEXICANO EM PP</h1>
            <p class="text-lg sm:text-xl text-neutral-500 font-medium">Plano de organização para 7 comerem 1 mexicano!</p>
        </header>

        <nav class="mb-8 sm:mb-10">
            <div class="flex justify-between border-b-2 border-neutral-200">
                <button class="tab-button active flex-1 text-sm sm:text-xl font-bold py-4 px-1 sm:px-2" data-target="visao-geral">Visão Geral</button>
                <button class="tab-button flex-1 text-sm sm:text-xl font-bold py-4 px-1 sm:px-2" data-target="receitas">Receitas</button>
                <button class="tab-button flex-1 text-sm sm:text-xl font-bold py-4 px-1 sm:px-2" data-target="lista-compras">Lista de Compras</button>
                <button class="tab-button flex-1 text-sm sm:text-xl font-bold py-4 px-1 sm:px-2" data-target="orcamento">Orçamento</button>
            </div>
        </nav>

        <main>
            <section id="visao-geral" class="tab-content">
                <div class="content-card p-6 sm:p-8">
                    <h2 class="text-3xl font-bold text-red-600 mb-4">O Plano Interativo</h2>
                    <p class="text-lg mb-6 text-neutral-600">Este guia transforma a organização do seu jantar em uma experiência fluida. Use as abas acima para navegar entre o cardápio, o preparo detalhado, a lista de compras marcável e o orçamento que se atualiza em tempo real. Tudo pensado para facilitar sua festa em Videira, SC!</p>
                    
                    <h3 class="text-2xl font-semibold text-red-600 mb-4">Cardápio de Sabor e Ação (7 Pessoas + Sobremesa)</h3>
                    <ul class="list-disc list-inside space-y-3 text-lg pl-4">
                        <li class="font-medium"><strong>Nachos Crocantes:</strong> Doritos como base perfeita para mergulhar.</li>
                        <li class="font-medium"><strong>Tacos Práticos:</strong> Usando Rap10, aquecidos para simular tortillas macias.</li>
                        <li class="font-medium"><strong>Carne Moída Picante:</strong> O recheio robusto e cheio de tempero (Quantidade ajustada para 7).</li>
                        <li class="font-medium"><strong>Guacamole Refrescante:</strong> Acompanhamento essencial, com a quantidade ajustada de abacates (Quantidade ajustada para 7).</li>
                        <li class="font-medium"><strong>Cheddar Turbinado:</strong> Cremoso e abundante graças ao toque de creme de leite.</li>
                        <li class="font-medium"><strong>Sour Cream Caseiro:</strong> O molho azedinho feito na hora para equilibrar a pimenta.</li>
                        <li class="font-medium"><strong>Final Feliz (Sobremesa):</strong> Torta Cremosa de Farofa (caseira) e um pote de Sorvete gelado.</li>
                        <li class="font-medium"><strong>Toque Fresco:</strong> Alface Americana para colocarmos nos tacos.</li>
                    </ul>
                </div>
            </section>

            <section id="receitas" class="tab-content hidden">
                <div class="content-card p-6 sm:p-8">
                    <div class="recipe-tab-container mb-8">
                        <button class="recipe-tab-button active w-[calc(50%-4px)] sm:w-auto text-xs sm:text-base font-bold py-3 px-4 sm:px-6 rounded-full bg-neutral-100 text-neutral-700" data-target="recipe-carne">Carne Moída</button>
                        <button class="recipe-tab-button w-[calc(50%-4px)] sm:w-auto text-xs sm:text-base font-bold py-3 px-4 sm:px-6 rounded-full bg-neutral-100 text-neutral-700" data-target="recipe-guacamole">Guacamole</button>
                        <button class="recipe-tab-button w-[calc(50%-4px)] sm:w-auto text-xs sm:text-base font-bold py-3 px-4 sm:px-6 rounded-full bg-neutral-100 text-neutral-700" data-target="recipe-cheddar">Cheddar Cremoso</button>
                        <button class="recipe-tab-button w-[calc(50%-4px)] sm:w-auto text-xs sm:text-base font-bold py-3 px-4 sm:px-6 rounded-full bg-neutral-100 text-neutral-700" data-target="recipe-sour-cream">Sour Cream</button>
                        <!-- Nova Aba de Receita -->
                        <button class="recipe-tab-button w-[calc(50%-4px)] sm:w-auto text-xs sm:text-base font-bold py-3 px-4 sm:px-6 rounded-full bg-neutral-100 text-neutral-700" data-target="recipe-torta">Torta Cremosa</button>
                    </div>

                    <div id="recipe-carne" class="recipe-content">
                        <h3 class="text-2xl sm:text-3xl font-bold text-red-600 mb-4">Carne Moída Apimentada (Para 7 Pessoas)</h3>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 sm:gap-8">
                            <div class="md:col-span-1 p-4 bg-neutral-50 rounded-lg">
                                <h4 class="text-xl font-semibold mb-3 text-amber-600">Ingredientes:</h4>
                                <ul class="list-disc list-inside space-y-1 text-neutral-700">
                                    <li><strong>1.1 kg</strong> de carne moída (patinho ou acém)</li>
                                    <li>2 cebolas grandes picadas</li>
                                    <li>4 dentes de alho picados</li>
                                    <li>1 pimenta dedo-de-moça picada (ou pimenta calabresa a gosto)</li>
                                    <li>2 colheres de sopa de páprica doce ou defumada</li>
                                    <li>1 colher de sopa de cominho em pó</li>
                                    <li>1 lata pequena de molho de tomate (ou 2 tomates picados)</li>
                                    <li>Azeite, sal e pimenta do reino a gosto</li>
                                </ul>
                            </div>
                            <div class="md:col-span-2">
                                <h4 class="text-xl font-semibold mb-3 text-amber-600">Preparo (Fácil e Rápido):</h4>
                                <ol class="list-decimal list-inside space-y-3 text-neutral-700">
                                    <li>Em uma panela grande, aqueça azeite e refogue a cebola e o alho.</li>
                                    <li>Adicione a carne e mexa para soltar. Cozinhe até perder o tom rosado.</li>
                                    <li>Escorra o excesso de líquido se necessário. Adicione a pimenta, páprica e cominho. Refogue por 1 minuto.</li>
                                    <li>Acrescente o molho de tomate, sal e pimenta. Cozinhe em fogo baixo por 15-20 minutos, mexendo ocasionalmente.</li>
                                </ol>
                            </div>
                        </div>
                    </div>

                    <div id="recipe-guacamole" class="recipe-content hidden">
                        <h3 class="text-2xl sm:text-3xl font-bold text-red-600 mb-4">Guacamole (Obrigatório! - Para 7 Pessoas)</h3>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 sm:gap-8">
                            <div class="md:col-span-1 p-4 bg-neutral-50 rounded-lg">
                                <h4 class="text-xl font-semibold mb-3 text-amber-600">Ingredientes:</h4>
                                <ul class="list-disc list-inside space-y-1 text-neutral-700">
                                    <li><strong>3 abacates</strong> médios (maduros)</li>
                                    <li>2 tomates maduros, sem sementes, picados</li>
                                    <li>1 cebola roxa pequena picada</li>
                                    <li>Suco de 2-3 limões (o segredo para não escurecer)</li>
                                    <li>1/2 maço de coentro picado</li>
                                    <li>Azeite extra-virgem, Sal e Pimenta do reino a gosto</li>
                                </ul>
                            </div>
                            <div class="md:col-span-2">
                                <h4 class="text-xl font-semibold mb-3 text-amber-600">Preparo (Frescor Total):</h4>
                                <ol class="list-decimal list-inside space-y-3 text-neutral-700">
                                    <li>Amasse a polpa dos abacates com um garfo, deixando-o rústico.</li>
                                    <li>Misture imediatamente o suco de limão para manter a cor viva.</li>
                                    <li>Adicione a cebola roxa, o tomate e o coentro.</li>
                                    <li>Tempere com sal, pimenta e azeite. Misture levemente.</li>
                                    <li>Refrigere coberto (plástico filme encostando no creme) por 15 minutos.</li>
                                </ol>
                            </div>
                        </div>
                    </div>

                    <div id="recipe-cheddar" class="recipe-content hidden">
                        <h3 class="text-2xl sm:text-3xl font-bold text-red-600 mb-4">Cheddar Cremoso Gourmet</h3>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 sm:gap-8">
                            <div class="md:col-span-1 p-4 bg-neutral-50 rounded-lg">
                                <h4 class="text-xl font-semibold mb-3 text-amber-600">Ingredientes:</h4>
                                <ul class="list-disc list-inside space-y-1 text-neutral-700">
                                    <li>400g de queijo cheddar processado (para derreter)</li>
                                    <li>2 caixas de creme de leite (400g total)</li>
                                </ul>
                            </div>
                            <div class="md:col-span-2">
                                <h4 class="text-xl font-semibold mb-3 text-amber-600">Preparo (Cremoso e Rendeiro):</h4>
                                <ol class="list-decimal list-inside space-y-3 text-neutral-700">
                                    <li>Aqueça o creme de leite em fogo baixo (sem ferver).</li>
                                    <li>Adicione o cheddar e mexa continuamente até obter um molho homogêneo.</li>
                                    <li>Sirva imediatamente para aproveitar a cremosidade. Reaqueça se necessário.</li>
                                </ol>
                            </div>
                        </div>
                    </div>

                    <div id="recipe-sour-cream" class="recipe-content hidden">
                        <h3 class="text-2xl sm:text-3xl font-bold text-red-600 mb-4">Sour Cream Caseiro</h3>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 sm:gap-8">
                            <div class="md:col-span-1 p-4 bg-neutral-50 rounded-lg">
                                <h4 class="text-xl font-semibold mb-3 text-amber-600">Ingredientes:</h4>
                                <ul class="list-disc list-inside space-y-1 text-neutral-700">
                                    <li>1 pote de creme de leite fresco ou nata (aprox. 300g)</li>
                                    <li>Suco de 1 limão</li>
                                    <li>1 pitada de sal</li>
                                </ul>
                            </div>
                            <div class="md:col-span-2">
                                <h4 class="text-xl font-semibold mb-3 text-amber-600">Preparo (Toque Azedinho):</h4>
                                <ol class="list-decimal list-inside space-y-3 text-neutral-700">
                                    <li>Misture o creme de leite/nata com o suco de limão e o sal.</li>
                                    <li>Bata com um batedor para incorporar ar.</li>
                                    <li>Deixe descansar em temperatura ambiente (ou na geladeira) por 30 a 60 minutos para engrossar levemente e desenvolver a acidez.</li>
                                    <li>Mantenha refrigerado até a hora H.</li>
                                </ol>
                            </div>
                        </div>
                    </div>

                    <div id="recipe-torta" class="recipe-content hidden">
                        <h3 class="text-2xl sm:text-3xl font-bold text-red-600 mb-4">Torta Cremosa de Farofa (Sobremesa Caseira)</h3>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 sm:gap-8">
                            <div class="md:col-span-1 p-4 bg-neutral-50 rounded-lg">
                                <h4 class="text-xl font-semibold mb-3 text-amber-600">Ingredientes:</h4>
                                <ul class="list-disc list-inside space-y-1 text-neutral-700">
                                    <li><strong>Massa (Farofa):</strong> Farinha, Açúcar e Margarina (ou Manteiga)</li>
                                    <li><strong>Creme:</strong> Leite Condensado (1 lata), Creme de Leite (1 caixa), Leite (1 xícara), Ovos (4 gemas e 2 claras)</li>
                                </ul>
                            </div>
                            <div class="md:col-span-2">
                                <h4 class="text-xl font-semibold mb-3 text-amber-600">Preparo (Otimizado):</h4>
                                <ol class="list-decimal list-inside space-y-3 text-neutral-700">
                                    <li><strong>Farofa:</strong> Misture farinha, açúcar e margarina (ou manteiga) até formar uma farofa solta, semelhante a de cuca. Forre o fundo e laterais de uma forma.</li>
                                    <li><strong>Creme:</strong> Misture o Leite Condensado, Leite, gemas e 1 caixa de Creme de Leite. Cozinhe em fogo baixo até engrossar levemente (ponto de brigadeiro mole).</li>
                                    <li><strong>Montagem (Dica do Áudio!):</strong> Derrame o creme <em>ainda quente</em> sobre a farofa. Isso ajuda na textura final da torta.</li>
                                    <li>Bata as duas claras em neve e adicione o restante do Creme de Leite por cima da torta, para a cobertura (opcional, mas delicioso).</li>
                                    <li>Finalize cobrindo com o restante da farofa.</li>
                                    <li><strong>Forno:</strong> Asse em forno médio (150°C - 180°C) por cerca de 40 minutos, ou até a farofa dourar e ficar crocante.</li>
                                </ol>
                            </div>
                        </div>
                    </div>

                </div>
            </section>

            <section id="lista-compras" class="tab-content hidden">
                <div class="content-card p-6 sm:p-8">
                    <h2 class="text-3xl font-bold text-red-600 mb-6">Sua Lista de Compras (Interativa)</h2>
                    <p class="mb-8 text-lg text-neutral-600">Marque os itens à medida que os adiciona ao carrinho. O orçamento total (aba 'Orçamento') já inclui o custo de <strong>TODOS os itens</strong> desta lista, calculados para <strong>7 pessoas</strong> no jantar e sobremesa completa.</p>
                    <div id="shopping-list-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    </div>
                </div>
            </section>

            <section id="orcamento" class="tab-content hidden">
                <div class="content-card p-6 sm:p-8">
                    <h2 class="text-3xl font-bold text-red-600 mb-6">Análise Orçamentária (R$)</h2>
                    <p class="text-lg mb-8 text-neutral-600">Veja a distribuição dos gastos por categoria. O total inclui a correção de 10% para imprevistos e variações de preço em Videira, SC. Os valores representam o custo total da lista de compras.</p>
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 items-center">
                        <div class="chart-container">
                            <canvas id="budgetChart"></canvas>
                        </div>
                        <div class="space-y-4">
                            
                            <div class="space-y-4 text-lg p-6 bg-neutral-50 rounded-xl shadow-inner">
                                <div class="flex justify-between pb-2 border-b border-neutral-200">
                                    <span class="font-medium text-neutral-600">Subtotal Itens:</span>
                                    <span id="subtotal-value" class="font-bold text-neutral-800">R$ 0,00</span>
                                </div>
                                <div class="flex justify-between pb-2 border-b border-neutral-200">
                                    <span class="font-medium text-neutral-600">Correção (+10% Imprevistos):</span>
                                    <span id="adjustment-value" class="font-bold text-red-500">R$ 0,00</span>
                                </div>
                                <div class="flex justify-between p-4 bg-amber-500 text-white rounded-lg text-2xl shadow-lg">
                                    <span class="font-extrabold tracking-wide">TOTAL ESTIMADO:</span>
                                    <span id="total-value" class="font-extrabold">R$ 0,00</span>
                                </div>
                                <p class="text-center text-neutral-500 text-base pt-4">Valor por pessoa (<strong>7</strong> convidados): <span id="per-person-value" class="font-bold text-red-600">R$ 0,00</span></p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <script>
        const shoppingListData = [
            { category: 'Açougue', index: 0, items: [
                // 1.5kg * 0.7 = 1.05kg -> 1.1kg. Preço R$ 45.00 -> R$ 33.00 (ajustado por kg)
                { name: 'Carne Moída (Patinho/Acém)', qty: '1.1 kg', price: 33.00, checked: false }
            ]},
            { category: 'Hortifruti', index: 1, items: [
                // 4 * 0.7 = 2.8 -> 3 unidades. Preço R$ 20.00 -> R$ 15.00
                { name: 'Abacate Médio (ou Avocado)', qty: '3 unidades', price: 15.00, checked: false },
                // Mantido para não quebrar a receita e o uso
                { name: 'Tomate', qty: 'aprox. 4 unidades', price: 5.00, checked: false },
                { name: 'Cebola Roxa', qty: '1 unidade', price: 2.00, checked: false },
                { name: 'Cebola Branca', qty: '2 unidades', price: 2.00, checked: false },
                { name: 'Coentro', qty: '1 maço', price: 3.00, checked: false },
                { name: 'Limão Tahiti', qty: 'aprox. 4 unidades', price: 3.00, checked: false },
                { name: 'Alho', qty: '1 cabeça', price: 3.00, checked: false },
                { name: 'Alface Americana', qty: '2 pés', price: 8.00, checked: false },
                { name: 'Pimenta Dedo-de-Moça', qty: '2 unidades', price: 3.00, checked: false },
                // Item da Torta (Fixado)
                { name: 'Ovos', qty: '4 unidades (para a torta)', price: 4.00, checked: false }
            ]},
            { category: 'Laticínios', index: 2, items: [
                // Mantido para receita do Cheddar e Sour Cream
                { name: 'Cheddar Processado (Bisnaga/Pote)', qty: '400g', price: 25.00, checked: false },
                // Mantido: 1 para torta (fixo), 2 para cheddar/molho (aprox. 2.4 necessário)
                { name: 'Creme de Leite (Caixa)', qty: '3 caixas (2 p/ cheddar, 1 p/ torta)', price: 9.00, checked: false },
                { name: 'Creme de Leite Fresco (ou Nata)', qty: '300g (p/ Sour Cream)', price: 15.00, checked: false },
                // Item da Torta (Fixado)
                { name: 'Manteiga', qty: '200g', price: 10.00, checked: false },
                // Item da Torta (Fixado)
                { name: 'Leite Integral', qty: '1 litro (p/ torta)', price: 5.00, checked: false }
            ]},
            { category: 'Mercearia', index: 3, items: [
                // 3 * 0.7 = 2.1 -> 2 pacotes. Preço R$ 60.00 -> R$ 40.00
                { name: 'Doritos (Pacote Grande)', qty: '2 pacotes', price: 40.00, checked: false },
                // 3 * 0.7 = 2.1 -> 2 pacotes. Preço R$ 30.00 -> R$ 20.00
                { name: 'Rap10 (Pacote c/ 10)', qty: '2 pacotes', price: 20.00, checked: false },
                // Tempero (Não-escalável)
                { name: 'Pimenta Calabresa (seco)', qty: '1 pct', price: 4.00, checked: false },
                { name: 'Cominho em Pó', qty: '1 pct', price: 4.00, checked: false },
                { name: 'Páprica Doce/Defumada', qty: '1 pct', price: 5.00, checked: false },
                { name: 'Molho de Tomate (Lata/Sachê)', qty: '1 unidade', price: 3.00, checked: false },
                // Item da Torta (Fixado)
                { name: 'Açúcar', qty: '1 kg (p/ torta)', price: 6.00, checked: false },
                // Item da Torta (Fixado)
                { name: 'Leite Condensado', qty: '1 lata (p/ torta)', price: 6.00, checked: false },
            ]},
            { category: 'Padaria & Confeitaria', index: 4, items: [
                // Item da Torta (Fixado)
                { name: 'Farinha de Trigo', qty: '1 kg', price: 5.00, checked: false },
                // Item da Torta (Fixado)
                { name: 'Margarina', qty: '250g (p/ massa da torta)', price: 7.00, checked: false },
            ]},
            { category: 'Sobremesa Pronta', index: 5, items: [
                // Sobremesa (Fixado)
                { name: 'Sorvete (Pote 1.5L)', qty: '1 pote', price: 30.00, checked: false }
            ]}
        ];

        let myBudgetChart;
        // 6 categorias agora
        const categoryTotals = [0, 0, 0, 0, 0, 0];
        const categoryLabels = ['Açougue', 'Hortifruti', 'Laticínios', 'Mercearia', 'Padaria & Confeitaria', 'Sobremesa Pronta'];
        /* New warmer and more harmonious palette */
        const categoryColors = ['#DC2626', '#16A34A', '#F59E0B', '#D97706', '#EC4899', '#6D28D9']; /* Red, Green, Amber, Orange, Pink, Violet */

        // Constante para o número de pessoas (agora 7)
        const totalGuests = 7;

        function toBRL(value) {
            return value.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });
        }

        function updateBudget() {
            let subtotal = 0;
            categoryTotals.fill(0);

            // O orçamento agora sempre soma o valor total de todos os itens, ignorando o status 'checked'.
            shoppingListData.forEach(category => {
                category.items.forEach(item => {
                    // Soma todos os itens para o Subtotal e para a categoria
                    subtotal += item.price;
                    categoryTotals[category.index] += item.price;
                });
            });

            const adjustment = subtotal * 0.10;
            const total = subtotal + adjustment;
            // Cálculo por pessoa baseado em 7
            const perPerson = total / totalGuests;

            document.getElementById('subtotal-value').textContent = toBRL(subtotal);
            document.getElementById('adjustment-value').textContent = toBRL(adjustment);
            document.getElementById('total-value').textContent = toBRL(total);
            document.getElementById('per-person-value').textContent = toBRL(perPerson);

            if (myBudgetChart) {
                myBudgetChart.data.datasets[0].data = categoryTotals;
                myBudgetChart.data.labels = categoryLabels;
                myBudgetChart.update();
            }
        }

        function populateShoppingList() {
            const container = document.getElementById('shopping-list-container');
            container.innerHTML = '';
            
            shoppingListData.forEach((category, catIndex) => {
                const categoryDiv = document.createElement('div');
                categoryDiv.className = 'mb-6 p-4 border border-neutral-200 rounded-xl bg-neutral-50 shadow-sm';
                
                const categoryTitle = document.createElement('h3');
                categoryTitle.className = 'text-xl font-bold text-amber-600 mb-4 border-b border-amber-200 pb-2';
                categoryTitle.textContent = category.category;
                categoryDiv.appendChild(categoryTitle);

                const itemList = document.createElement('ul');
                itemList.className = 'space-y-3';

                category.items.forEach((item, itemIndex) => {
                    const li = document.createElement('li');
                    li.className = 'flex items-center hover:bg-white p-2 rounded-lg transition duration-150';

                    const label = document.createElement('label');
                    label.className = 'flex items-center w-full cursor-pointer';

                    const checkbox = document.createElement('input');
                    checkbox.type = 'checkbox';
                    checkbox.checked = item.checked;
                    checkbox.className = 'h-5 w-5 rounded border-neutral-400 text-red-600 focus:ring-red-500';
                    checkbox.dataset.catIndex = catIndex;
                    checkbox.dataset.itemIndex = itemIndex;

                    // O checkbox agora apenas atualiza o estado interno, mas não afeta o orçamento
                    checkbox.addEventListener('change', (e) => {
                        const cIdx = parseInt(e.target.dataset.catIndex);
                        const iIdx = parseInt(e.target.dataset.itemIndex);
                        shoppingListData[cIdx].items[iIdx].checked = e.target.checked;
                    });

                    const textSpan = document.createElement('span');
                    textSpan.className = 'ml-3 flex-1 text-neutral-700';
                    textSpan.textContent = `${item.name} (${item.qty})`;

                    const priceSpan = document.createElement('span');
                    priceSpan.className = 'font-semibold text-neutral-600';
                    priceSpan.textContent = toBRL(item.price);

                    label.appendChild(checkbox);
                    label.appendChild(textSpan);
                    label.appendChild(priceSpan);
                    li.appendChild(label);
                    itemList.appendChild(li);
                });

                categoryDiv.appendChild(itemList);
                container.appendChild(categoryDiv);
            });
        }

        function setupBudgetChart() {
            const ctx = document.getElementById('budgetChart').getContext('2d');
            myBudgetChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: categoryLabels,
                    datasets: [{
                        label: 'Custo por Categoria',
                        data: categoryTotals,
                        backgroundColor: categoryColors,
                        borderColor: '#F9FAFB',
                        borderWidth: 4,
                        hoverBorderColor: '#fff',
                        hoverBorderWidth: 6
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                font: {
                                    family: 'Inter',
                                    size: 14,
                                }
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    let label = context.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.parsed) {
                                        label += toBRL(context.parsed);
                                    }
                                    return label;
                                }
                            }
                        }
                    }
                }
            });
        }

        function setupTabs() {
            const tabButtons = document.querySelectorAll('.tab-button');
            const tabContents = document.querySelectorAll('.tab-content');

            tabButtons.forEach(button => {
                button.addEventListener('click', () => {
                    tabButtons.forEach(btn => btn.classList.remove('active'));
                    button.classList.add('active');

                    const target = button.getAttribute('data-target');
                    tabContents.forEach(content => {
                        content.classList.add('hidden');
                        if (content.id === target) {
                            content.classList.remove('hidden');
                        }
                    });

                    if (target === 'orcamento') {
                        // Sempre chama o updateBudget() quando abre a tela de orçamento
                        if (!myBudgetChart) {
                            setupBudgetChart();
                        }
                        updateBudget();
                    }
                });
            });
        }

        function setupRecipeTabs() {
            const recipeTabButtons = document.querySelectorAll('.recipe-tab-button');
            const recipeContents = document.querySelectorAll('.recipe-content');

            recipeTabButtons.forEach(button => {
                button.addEventListener('click', () => {
                    recipeTabButtons.forEach(btn => btn.classList.remove('active', 'bg-amber-600', 'text-white'));
                    button.classList.add('active');
                    if (button.classList.contains('active')) {
                        button.classList.add('bg-amber-600', 'text-white');
                    }

                    const target = button.getAttribute('data-target');
                    recipeContents.forEach(content => {
                        content.classList.add('hidden');
                        if (content.id === target) {
                            content.classList.remove('hidden');
                        }
                    });
                });
            });
            // Initial activation for the first recipe tab
            if (recipeTabButtons.length > 0) {
                 recipeTabButtons[0].classList.add('bg-amber-600', 'text-white');
            }
        }

        window.addEventListener('DOMContentLoaded', () => {
            setupTabs();
            setupRecipeTabs();
            populateShoppingList();
            // Chamada inicial para garantir que os valores de orçamento estejam corretos na primeira abertura
            updateBudget(); 
        });
    </script>
</body>
</html>
