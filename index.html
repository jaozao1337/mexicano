<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>MEXICANO EM PP | App Oficial</title>
    <link rel="icon" type="image/png" href="mexicano.png">
    
    <!-- Tech Stack: Tailwind CSS + Chart.js + Google Fonts -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Outfit:wght@400;700;800&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        display: ['Outfit', 'sans-serif'],
                    },
                    colors: {
                        mex: {
                            red: '#B0302F',
                            blue: '#3575A2',
                            orange: '#CF6A00',
                            yellow: '#EB8F2C',
                            green: '#276124',
                            pink: '#B0367F',
                            bg: '#FFF8F0', // Fundo creme suave
                            surface: '#FFFFFF'
                        }
                    },
                    boxShadow: {
                        'soft': '0 10px 40px -10px rgba(0,0,0,0.08)',
                        'glow': '0 0 20px rgba(207, 106, 0, 0.15)'
                    }
                }
            }
        }
    </script>

    <style>
        body {
            -webkit-tap-highlight-color: transparent;
            background-color: #FFF8F0;
            background-image: radial-gradient(#CF6A00 0.5px, transparent 0.5px);
            background-size: 20px 20px;
            background-position: 0 0;
            opacity: 1;
        }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: transparent;
        }
        ::-webkit-scrollbar-thumb {
            background: #EB8F2C;
            border-radius: 4px;
        }

        /* Animations */
        .fade-in { animation: fadeIn 0.4s ease-out forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* Checkbox Customization */
        .custom-checkbox:checked + div {
            background-color: #276124;
            border-color: #276124;
        }
        .custom-checkbox:checked + div svg {
            display: block;
        }
        
        /* Glassmorphism Sticky Nav */
        .glass-nav {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border-bottom: 1px solid rgba(0,0,0,0.05);
        }
    </style>
</head>
<body class="text-gray-800 antialiased pb-20">

    <!-- Floating Header & Nav -->
    <div class="fixed top-0 left-0 right-0 z-50 glass-nav shadow-sm transition-all duration-300" id="main-nav">
        <div class="max-w-5xl mx-auto px-4 sm:px-6">
            <div class="flex flex-col sm:flex-row justify-between items-center py-3 sm:py-4 gap-3">
                <!-- Logo Area -->
                <div class="flex items-center gap-3">
                    <div class="w-10 h-10 rounded-xl bg-gradient-to-br from-mex-red to-mex-orange flex items-center justify-center text-white font-display font-bold text-xl shadow-lg transform -rotate-3">
                        M
                    </div>
                    <div>
                        <h1 class="font-display font-bold text-xl text-gray-900 leading-none tracking-tight">MEXICANO EM PP</h1>
                        <p class="text-xs text-mex-orange font-medium tracking-wide uppercase mt-0.5">7 Amigos ‚Ä¢ 1 Miss√£o</p>
                    </div>
                </div>

                <!-- Navigation Pills -->
                <nav class="flex bg-gray-100/50 p-1 rounded-full overflow-x-auto max-w-full no-scrollbar w-full sm:w-auto">
                    <button class="nav-btn flex-1 sm:flex-none px-4 py-2 rounded-full text-sm font-medium transition-all duration-200 text-gray-600 hover:text-mex-red whitespace-nowrap bg-white shadow-sm text-mex-red" onclick="switchTab('visao-geral', this)">
                        Vis√£o Geral
                    </button>
                    <button class="nav-btn flex-1 sm:flex-none px-4 py-2 rounded-full text-sm font-medium transition-all duration-200 text-gray-600 hover:text-mex-red whitespace-nowrap" onclick="switchTab('receitas', this)">
                        Receitas
                    </button>
                    <button class="nav-btn flex-1 sm:flex-none px-4 py-2 rounded-full text-sm font-medium transition-all duration-200 text-gray-600 hover:text-mex-red whitespace-nowrap" onclick="switchTab('lista-compras', this)">
                        Lista
                    </button>
                    <button class="nav-btn flex-1 sm:flex-none px-4 py-2 rounded-full text-sm font-medium transition-all duration-200 text-gray-600 hover:text-mex-red whitespace-nowrap" onclick="switchTab('orcamento', this)">
                        R$
                    </button>
                </nav>
            </div>
        </div>
    </div>

    <!-- Spacer for fixed header -->
    <div class="h-32 sm:h-28"></div>

    <!-- Main Content Container -->
    <main class="max-w-5xl mx-auto px-4 sm:px-6">

        <!-- SECTION: VIS√ÉO GERAL -->
        <section id="visao-geral" class="tab-content fade-in">
            <!-- Hero Card -->
            <div class="bg-white rounded-3xl p-6 sm:p-10 shadow-soft border border-orange-100 relative overflow-hidden mb-6">
                <div class="absolute top-0 right-0 w-64 h-64 bg-gradient-to-br from-mex-yellow to-mex-orange opacity-10 rounded-full blur-3xl -mr-16 -mt-16"></div>
                
                <h2 class="font-display font-bold text-3xl sm:text-4xl text-mex-red mb-4 relative z-10">O Plano Mestre üåÆ</h2>
                <p class="text-lg text-gray-600 mb-8 leading-relaxed relative z-10 max-w-2xl">
                    Um guia interativo moderno para organizar a noite mexicana perfeita em Videira, SC. 
                    Tudo calculado milimetricamente para <strong class="text-mex-orange">7 pessoas</strong> comerem muito bem, com zero desperd√≠cio e sabor m√°ximo.
                </p>

                <!-- Quick Stats Grid -->
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4 relative z-10">
                    <div class="bg-orange-50 p-4 rounded-2xl border border-orange-100">
                        <div class="text-2xl mb-1">üë®‚Äçüë©‚Äçüëß‚Äçüë¶</div>
                        <div class="font-bold text-mex-orange text-xl">7 Pessoas</div>
                        <div class="text-xs text-gray-500">Confirmados</div>
                    </div>
                    <div class="bg-red-50 p-4 rounded-2xl border border-red-100">
                        <div class="text-2xl mb-1">üå∂Ô∏è</div>
                        <div class="font-bold text-mex-red text-xl">1.1 kg</div>
                        <div class="text-xs text-gray-500">Carne Moida</div>
                    </div>
                    <div class="bg-green-50 p-4 rounded-2xl border border-green-100">
                        <div class="text-2xl mb-1">ü•ë</div>
                        <div class="font-bold text-mex-green text-xl">3 Units</div>
                        <div class="text-xs text-gray-500">Abacates</div>
                    </div>
                    <div class="bg-pink-50 p-4 rounded-2xl border border-pink-100">
                        <div class="text-2xl mb-1">ü•ß</div>
                        <div class="font-bold text-mex-pink text-xl">Torta</div>
                        <div class="text-xs text-gray-500">Sobremesa Top</div>
                    </div>
                </div>
            </div>

            <!-- Menu List -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="bg-white rounded-3xl p-6 shadow-sm border border-gray-100">
                    <h3 class="font-display font-bold text-xl text-mex-blue mb-4 flex items-center gap-2">
                        <span class="w-2 h-8 bg-mex-blue rounded-full"></span> Salgados (Self-Service)
                    </h3>
                    <ul class="space-y-3">
                        <li class="flex items-start gap-3"><span class="text-mex-orange mt-1">‚óè</span> <span><strong>Nachos:</strong> Doritos como base crocante.</span></li>
                        <li class="flex items-start gap-3"><span class="text-mex-orange mt-1">‚óè</span> <span><strong>Tacos:</strong> Rap10 aquecido na frigideira.</span></li>
                        <li class="flex items-start gap-3"><span class="text-mex-orange mt-1">‚óè</span> <span><strong>Carne:</strong> Bem temperada e apimentada.</span></li>
                        <li class="flex items-start gap-3"><span class="text-mex-orange mt-1">‚óè</span> <span><strong>Guacamole:</strong> O cl√°ssico fresco.</span></li>
                        <li class="flex items-start gap-3"><span class="text-mex-orange mt-1">‚óè</span> <span><strong>Cheddar:</strong> Molho cremoso turbinado.</span></li>
                        <li class="flex items-start gap-3"><span class="text-mex-orange mt-1">‚óè</span> <span><strong>Sour Cream:</strong> Azedinho para equilibrar.</span></li>
                    </ul>
                </div>
                <div class="bg-white rounded-3xl p-6 shadow-sm border border-gray-100">
                    <h3 class="font-display font-bold text-xl text-mex-pink mb-4 flex items-center gap-2">
                        <span class="w-2 h-8 bg-mex-pink rounded-full"></span> Sobremesas & Extras
                    </h3>
                    <ul class="space-y-3">
                        <li class="flex items-start gap-3 bg-pink-50 p-3 rounded-xl border border-pink-100">
                            <span class="text-xl">ü•ß</span> 
                            <span><strong>Torta Cremosa de Farofa:</strong> Caseira, montada quente. A estrela da noite.</span>
                        </li>
                        <li class="flex items-start gap-3">
                            <span class="text-xl">üç¶</span> 
                            <span><strong>Sorvete:</strong> Pote de 1.5L geladinho.</span>
                        </li>
                         <li class="flex items-start gap-3">
                            <span class="text-xl">ü•¨</span> 
                            <span><strong>Alface Americana:</strong> O toque crocante nos tacos.</span>
                        </li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- SECTION: RECEITAS -->
        <section id="receitas" class="tab-content hidden fade-in">
            <!-- Recipe Navigation -->
            <div class="flex overflow-x-auto gap-3 pb-4 mb-4 no-scrollbar" id="recipe-nav">
                <!-- Populated by JS -->
            </div>

            <!-- Recipe Content Area -->
            <div id="recipe-display" class="bg-white rounded-3xl shadow-soft overflow-hidden min-h-[400px] border border-gray-100">
                <!-- Content populated by JS -->
            </div>
        </section>

        <!-- SECTION: LISTA DE COMPRAS -->
        <section id="lista-compras" class="tab-content hidden fade-in">
            <div class="bg-mex-blue/10 rounded-2xl p-4 mb-6 flex items-start gap-3 border border-mex-blue/20">
                <div class="text-mex-blue text-xl">‚ÑπÔ∏è</div>
                <p class="text-sm text-mex-blue font-medium">
                    Toque nos itens para riscar. O or√ßamento total permanece fixo na previs√£o para 7 pessoas.
                </p>
            </div>
            <div id="shopping-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Populated by JS -->
            </div>
        </section>

        <!-- SECTION: OR√áAMENTO -->
        <section id="orcamento" class="tab-content hidden fade-in">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                
                <!-- Cards de Resumo Financeiro -->
                <div class="order-2 lg:order-1 space-y-4">
                    <div class="bg-white p-6 rounded-3xl shadow-soft border border-gray-100">
                         <h3 class="font-display font-bold text-gray-400 text-sm uppercase tracking-wider mb-1">Total Estimado (Lista Completa)</h3>
                         <div class="flex items-baseline gap-1">
                            <span class="text-gray-400 font-bold text-2xl">R$</span>
                            <span id="total-value" class="text-4xl font-display font-bold text-gray-900">0,00</span>
                         </div>
                         <div class="mt-4 pt-4 border-t border-gray-100 flex justify-between items-center">
                             <span class="text-gray-500">Por Pessoa (7)</span>
                             <span id="per-person-value" class="text-xl font-bold text-mex-green bg-green-50 px-3 py-1 rounded-lg">R$ 0,00</span>
                         </div>
                    </div>

                    <div class="bg-white p-6 rounded-3xl shadow-soft border border-gray-100">
                        <h3 class="font-display font-bold text-gray-400 text-sm uppercase tracking-wider mb-4">Detalhamento</h3>
                        <div class="space-y-3">
                            <div class="flex justify-between">
                                <span class="text-gray-600">Subtotal dos Itens</span>
                                <span id="subtotal-value" class="font-bold text-gray-900">R$ 0,00</span>
                            </div>
                            <div class="flex justify-between text-mex-red">
                                <span>Corre√ß√£o (+10% Margem)</span>
                                <span id="adjustment-value" class="font-bold">+ R$ 0,00</span>
                            </div>
                        </div>
                    </div>

                    <!-- Progresso de Compra -->
                    <div class="bg-mex-blue p-6 rounded-3xl shadow-lg text-white relative overflow-hidden">
                        <div class="absolute top-0 right-0 w-32 h-32 bg-white opacity-10 rounded-full -mr-10 -mt-10"></div>
                        <h3 class="font-bold text-white/80 text-sm uppercase mb-2">Status do Carrinho</h3>
                        <div class="flex justify-between items-end mb-2">
                            <span id="items-count" class="text-3xl font-display font-bold">0/0</span>
                            <span class="text-sm font-medium opacity-80">Itens riscados</span>
                        </div>
                        <div class="w-full bg-black/20 rounded-full h-2">
                            <div id="progress-bar" class="bg-white h-2 rounded-full transition-all duration-500" style="width: 0%"></div>
                        </div>
                    </div>
                </div>

                <!-- Gr√°fico -->
                <div class="order-1 lg:order-2 bg-white p-6 rounded-3xl shadow-soft border border-gray-100 flex flex-col items-center justify-center min-h-[400px]">
                    <h3 class="font-display font-bold text-gray-800 mb-6 w-full text-left">Distribui√ß√£o de Custos</h3>
                    <div class="chart-container w-full">
                        <canvas id="budgetChart"></canvas>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <script>
        // --- DADOS ---
        const recipes = [
            {
                id: 'carne',
                title: 'Carne Mo√≠da',
                color: 'mex-red', // class suffix
                bg: 'bg-mex-red',
                text: 'text-mex-red',
                icon: 'ü•©',
                ingredients: [
                    '1.1 kg de carne mo√≠da (patinho ou ac√©m)',
                    '2 cebolas grandes picadas',
                    '4 dentes de alho picados',
                    '1 pimenta dedo-de-mo√ßa picada',
                    '2 colheres de sopa de p√°prica doce',
                    '1 colher de sopa de cominho em p√≥',
                    '1 lata pequena de molho de tomate',
                    'Azeite, sal e pimenta do reino'
                ],
                steps: [
                    'Refogue a cebola e o alho no azeite.',
                    'Adicione a carne e cozinhe at√© perder a cor rosa.',
                    'Adicione pimenta, p√°prica e cominho. Refogue por 1 min.',
                    'Adicione molho, sal e pimenta. Cozinhe 15min em fogo baixo.'
                ]
            },
            {
                id: 'guacamole',
                title: 'Guacamole',
                color: 'mex-green',
                bg: 'bg-mex-green',
                text: 'text-mex-green',
                icon: 'ü•ë',
                ingredients: [
                    '3 abacates m√©dios maduros',
                    '2 tomates sem sementes picados',
                    '1 cebola roxa pequena picada',
                    'Suco de 2-3 lim√µes',
                    '1/2 ma√ßo de coentro picado',
                    'Azeite, Sal e Pimenta'
                ],
                steps: [
                    'Amasse os abacates grosseiramente.',
                    'Misture lim√£o imediatamente.',
                    'Adicione cebola, tomate e coentro.',
                    'Tempere e leve √† geladeira por 15min com filme pl√°stico.'
                ]
            },
            {
                id: 'cheddar',
                title: 'Cheddar',
                color: 'mex-orange',
                bg: 'bg-mex-orange',
                text: 'text-mex-orange',
                icon: 'üßÄ',
                ingredients: [
                    '400g cheddar processado',
                    '2 caixas de creme de leite'
                ],
                steps: [
                    'Aque√ßa o creme de leite em fogo baixo (n√£o ferva).',
                    'Adicione o cheddar e mexa at√© derreter.',
                    'Sirva quente.'
                ]
            },
            {
                id: 'sour',
                title: 'Sour Cream',
                color: 'mex-blue',
                bg: 'bg-mex-blue',
                text: 'text-mex-blue',
                icon: 'ü•£',
                ingredients: [
                    '1 pote nata/creme de leite fresco',
                    'Suco de 1 lim√£o',
                    '1 pitada de sal'
                ],
                steps: [
                    'Misture tudo com um fouet.',
                    'Deixe descansar 30min para engrossar.',
                    'Refrigere.'
                ]
            },
            {
                id: 'torta',
                title: 'Torta de Farofa',
                color: 'mex-pink',
                bg: 'bg-mex-pink',
                text: 'text-mex-pink',
                icon: 'ü•ß',
                ingredients: [
                    '<strong>Massa:</strong> Farinha, A√ß√∫car, Margarina',
                    '<strong>Creme:</strong> 1 Leite Condensado, 1 Creme de Leite, 1 x√≠c Leite, 4 gemas, 2 claras'
                ],
                steps: [
                    'Fa√ßa uma farofa com farinha, a√ß√∫car e margarina. Forre a forma.',
                    'Cozinhe o creme (leites + gemas) at√© ponto de brigadeiro mole.',
                    '<strong>Dica:</strong> Jogue o creme ainda quente na farofa.',
                    'Cubra com claras em neve + creme de leite restante (opcional) e mais farofa.',
                    'Asse a 180¬∞C por 40min.'
                ]
            }
        ];

        const shoppingList = [
             { category: 'A√ßougue', color: '#B0302F', items: [
                { name: 'Carne Mo√≠da (Patinho/Ac√©m)', qty: '1.1 kg', price: 33.00, checked: false }
            ]},
            { category: 'Hortifruti', color: '#276124', items: [
                { name: 'Abacate M√©dio', qty: '3 un', price: 15.00, checked: false },
                { name: 'Tomate', qty: '4 un', price: 5.00, checked: false },
                { name: 'Cebola Roxa', qty: '1 un', price: 2.00, checked: false },
                { name: 'Cebola Branca', qty: '2 un', price: 2.00, checked: false },
                { name: 'Coentro', qty: '1 ma√ßo', price: 3.00, checked: false },
                { name: 'Lim√£o Tahiti', qty: '4 un', price: 3.00, checked: false },
                { name: 'Alho', qty: '1 cabe√ßa', price: 3.00, checked: false },
                { name: 'Alface Americana', qty: '2 p√©s', price: 8.00, checked: false },
                { name: 'Pimenta Dedo-de-Mo√ßa', qty: '2 un', price: 3.00, checked: false },
                { name: 'Ovos', qty: '4 un (Torta)', price: 4.00, checked: false }
            ]},
            { category: 'Latic√≠nios', color: '#3575A2', items: [
                { name: 'Cheddar Processado', qty: '400g', price: 25.00, checked: false },
                { name: 'Creme de Leite', qty: '3 cx', price: 9.00, checked: false },
                { name: 'Nata / Creme Fresco', qty: '300g', price: 15.00, checked: false },
                { name: 'Manteiga', qty: '200g', price: 10.00, checked: false },
                { name: 'Leite Integral', qty: '1 L', price: 5.00, checked: false }
            ]},
            { category: 'Mercearia', color: '#CF6A00', items: [
                { name: 'Doritos Grande', qty: '2 pct', price: 40.00, checked: false },
                { name: 'Rap10', qty: '2 pct', price: 20.00, checked: false },
                { name: 'Pimenta Calabresa', qty: '1 pct', price: 4.00, checked: false },
                { name: 'Cominho', qty: '1 pct', price: 4.00, checked: false },
                { name: 'P√°prica', qty: '1 pct', price: 5.00, checked: false },
                { name: 'Molho Tomate', qty: '1 un', price: 3.00, checked: false },
                { name: 'A√ß√∫car', qty: '1 kg', price: 6.00, checked: false },
                { name: 'Leite Condensado', qty: '1 lata', price: 6.00, checked: false }
            ]},
            { category: 'Padaria', color: '#EB8F2C', items: [
                { name: 'Farinha Trigo', qty: '1 kg', price: 5.00, checked: false },
                { name: 'Margarina', qty: '250g', price: 7.00, checked: false }
            ]},
            { category: 'Sobremesa', color: '#B0367F', items: [
                { name: 'Sorvete 1.5L', qty: '1 pote', price: 30.00, checked: false }
            ]}
        ];

        // --- LOGIC ---
        
        // Navigation
        function switchTab(tabId, btn) {
            // Hide all sections
            document.querySelectorAll('.tab-content').forEach(el => el.classList.add('hidden'));
            // Show target
            document.getElementById(tabId).classList.remove('hidden');
            
            // Reset nav styles
            document.querySelectorAll('.nav-btn').forEach(el => {
                el.classList.remove('bg-white', 'shadow-sm', 'text-mex-red');
                el.classList.add('text-gray-600');
            });
            
            // Set active nav style
            btn.classList.remove('text-gray-600');
            btn.classList.add('bg-white', 'shadow-sm', 'text-mex-red');

            // Refresh context
            if(tabId === 'orcamento') renderChart();
        }

        // Recipe Renderer
        function renderRecipes() {
            const navContainer = document.getElementById('recipe-nav');
            const displayContainer = document.getElementById('recipe-display');
            
            // Create Nav Buttons
            navContainer.innerHTML = recipes.map((r, i) => `
                <button onclick="showRecipe('${r.id}')" 
                        class="flex-shrink-0 px-5 py-2 rounded-xl font-bold text-sm transition-all 
                        ${i === 0 ? r.bg + ' text-white shadow-lg ring-2 ring-offset-2 ring-' + r.color : 'bg-white text-gray-500 hover:bg-gray-50 border border-gray-100'} 
                        recipe-pill" 
                        data-id="${r.id}"
                        data-bg="${r.bg}"
                        data-color="${r.color}">
                    ${r.icon} ${r.title}
                </button>
            `).join('');

            // Initial Render
            showRecipe(recipes[0].id);
        }

        function showRecipe(id) {
            const recipe = recipes.find(r => r.id === id);
            
            // Update Nav Pills
            document.querySelectorAll('.recipe-pill').forEach(btn => {
                if(btn.dataset.id === id) {
                    btn.className = `flex-shrink-0 px-5 py-2 rounded-xl font-bold text-sm transition-all ${recipe.bg} text-white shadow-lg ring-2 ring-offset-2 ring-${recipe.color} recipe-pill scale-105`;
                } else {
                    btn.className = 'flex-shrink-0 px-5 py-2 rounded-xl font-bold text-sm transition-all bg-white text-gray-500 border border-gray-100 recipe-pill hover:bg-gray-50';
                }
            });

            // Update Content
            const content = document.getElementById('recipe-display');
            content.innerHTML = `
                <div class="relative fade-in h-full">
                    <div class="absolute top-0 right-0 p-6 opacity-10 text-9xl select-none pointer-events-none grayscale">
                        ${recipe.icon}
                    </div>
                    <div class="p-6 sm:p-8 relative z-10">
                        <h2 class="font-display font-bold text-3xl ${recipe.text} mb-6 border-b border-gray-100 pb-4">${recipe.title}</h2>
                        
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                            <div>
                                <h3 class="font-bold text-gray-900 mb-3 uppercase text-sm tracking-wider">Ingredientes</h3>
                                <ul class="space-y-2">
                                    ${recipe.ingredients.map(ing => `
                                        <li class="flex items-start gap-2 text-gray-700 text-sm sm:text-base">
                                            <span class="${recipe.text} mt-1">‚Ä¢</span>
                                            <span>${ing}</span>
                                        </li>
                                    `).join('')}
                                </ul>
                            </div>
                            <div class="bg-gray-50 rounded-2xl p-5 border border-gray-100">
                                <h3 class="font-bold text-gray-900 mb-3 uppercase text-sm tracking-wider">Modo de Preparo</h3>
                                <ol class="space-y-4">
                                    ${recipe.steps.map((step, i) => `
                                        <li class="flex gap-3 text-sm sm:text-base text-gray-700">
                                            <span class="flex-shrink-0 w-6 h-6 rounded-full ${recipe.bg} text-white flex items-center justify-center text-xs font-bold">${i+1}</span>
                                            <p>${step}</p>
                                        </li>
                                    `).join('')}
                                </ol>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Shopping List Renderer
        function renderShoppingList() {
            const container = document.getElementById('shopping-container');
            container.innerHTML = shoppingList.map((cat, catIdx) => `
                <div class="bg-white rounded-2xl p-5 shadow-sm border-l-4" style="border-left-color: ${cat.color}">
                    <h3 class="font-bold text-lg mb-3" style="color: ${cat.color}">${cat.category}</h3>
                    <ul class="space-y-3">
                        ${cat.items.map((item, itemIdx) => `
                            <li class="group flex items-center justify-between p-2 hover:bg-gray-50 rounded-lg transition-colors cursor-pointer" onclick="toggleItem(${catIdx}, ${itemIdx})">
                                <div class="flex items-center gap-3 w-full">
                                    <div class="relative">
                                        <input type="checkbox" 
                                               class="peer appearance-none w-5 h-5 border-2 border-gray-300 rounded-md checked:border-none custom-checkbox transition-all pointer-events-none"
                                               ${item.checked ? 'checked' : ''}>
                                        <div class="hidden absolute inset-0 bg-mex-green rounded-md flex items-center justify-center pointer-events-none text-white">
                                            <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"></path></svg>
                                        </div>
                                    </div>
                                    <span class="text-gray-700 text-sm sm:text-base select-none flex-1 transition-all duration-300 ${item.checked ? 'line-through text-gray-400 decoration-2 decoration-mex-orange/50' : ''}">
                                        ${item.name} 
                                        <span class="text-xs block ${item.checked ? 'text-gray-300' : 'text-gray-400'}">${item.qty}</span>
                                    </span>
                                </div>
                                <span class="text-sm font-bold text-gray-900 bg-gray-100 px-2 py-1 rounded whitespace-nowrap ${item.checked ? 'opacity-50' : ''}">${item.price.toLocaleString('pt-BR', {style: 'currency', currency: 'BRL'})}</span>
                            </li>
                        `).join('')}
                    </ul>
                </div>
            `).join('');
            
            updateProgress();
        }

        function toggleItem(catIdx, itemIdx) {
            // Toggle state
            shoppingList[catIdx].items[itemIdx].checked = !shoppingList[catIdx].items[itemIdx].checked;
            // Re-render the list to apply styles immediately
            renderShoppingList();
        }

        // Budget Logic
        function calculateBudget() {
            let subtotal = 0;
            const categoryTotals = shoppingList.map(cat => {
                const catSum = cat.items.reduce((acc, item) => acc + item.price, 0);
                subtotal += catSum;
                return catSum;
            });
            
            const adjustment = subtotal * 0.10;
            const total = subtotal + adjustment;
            const perPerson = total / 7;

            // DOM Updates
            const toCurrency = (val) => val.toLocaleString('pt-BR', {style: 'currency', currency: 'BRL'});
            
            document.getElementById('total-value').innerText = toCurrency(total).replace('R$', '').trim(); // Big number logic
            document.getElementById('subtotal-value').innerText = toCurrency(subtotal);
            document.getElementById('adjustment-value').innerText = "+ " + toCurrency(adjustment);
            document.getElementById('per-person-value').innerText = toCurrency(perPerson);

            return { categoryTotals };
        }

        function updateProgress() {
            let totalItems = 0;
            let checkedItems = 0;
            
            shoppingList.forEach(cat => {
                cat.items.forEach(item => {
                    totalItems++;
                    if(item.checked) checkedItems++;
                });
            });

            const percentage = (checkedItems / totalItems) * 100;
            document.getElementById('items-count').innerText = `${checkedItems}/${totalItems}`;
            document.getElementById('progress-bar').style.width = `${percentage}%`;
        }

        let chartInstance = null;

        function renderChart() {
            const { categoryTotals } = calculateBudget();
            const ctx = document.getElementById('budgetChart').getContext('2d');
            
            if(chartInstance) chartInstance.destroy();

            chartInstance = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: shoppingList.map(c => c.category),
                    datasets: [{
                        data: categoryTotals,
                        backgroundColor: shoppingList.map(c => c.color),
                        borderWidth: 0,
                        hoverOffset: 10
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                font: { family: 'Inter', size: 12 },
                                usePointStyle: true,
                                padding: 20
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(255, 255, 255, 0.95)',
                            titleColor: '#111',
                            bodyColor: '#333',
                            borderColor: '#eee',
                            borderWidth: 1,
                            callbacks: {
                                label: function(context) {
                                    return " " + context.parsed.toLocaleString('pt-BR', {style: 'currency', currency: 'BRL'});
                                }
                            }
                        }
                    },
                    cutout: '65%'
                }
            });
        }

        // --- INIT ---
        window.addEventListener('DOMContentLoaded', () => {
            renderRecipes();
            renderShoppingList();
            calculateBudget();
        });

    </script>
</body>
</html>
